<?php

class Adherent extends Objet
{

    protected static $objet = "Adherent";
    protected static $cle = "login";
    protected $login;
    protected $mdp;
    protected $nomAdherent;
    protected $prenomAdherent;
    protected $email;
    protected $dateAdhesion;
    protected $isAdmin;
    protected $numCategorie;

    public function isAdmin() {
        return $this->isAdmin == 1;
    }

    public function affichable()
    {
        return !$this->isAdmin; // TODO: Change the autogenerated stub
    }

    public function afficher(){
        return $this->get('nomAdherent') . " " . $this->get('prenomAdherent') . " : " . $this->get('dateAdhesion');
    }

    public function __construct($data = NULL)
    {
        parent::__construct($data);
    }

    public function get($attribut)
    {
        return parent::get($attribut); // TODO: Change the autogenerated stub
    }

    public function set($attribut, $valeur)
    {
        parent::set($attribut, $valeur); // TODO: Change the autogenerated stub
    }

    public static function addAdherent($login, $mdp, $nom, $prenom, $email, $dateAdhesion){
        $requete = "INSERT INTO Adherent (login, mdp, nomAdherent, prenomAdherent, email, dateAdhesion, numCategorie, isAdmin) VALUES (:login, :mdp, :nomAdherent, :prenomAdherent, :email, :dateAdhesion, 1, 0)";
        $req_prep = Connexion::pdo()->prepare($requete);
        $tab = array(
            "login" => $login,
            "mdp" => $mdp,
            "nomAdherent" => $nom,
            "prenomAdherent" => $prenom,
            "email" => $email,
            "dateAdhesion" => $dateAdhesion,
        );
        try {
            $req_prep->execute($tab);
            return true;
        } catch (PDOException $e) {
            echo "Erreur d'ajout : " . $e->getMessage();
            return false;
        }
    }

    public static function updateAdherent($login, $mdp, $nom, $prenom, $email, $dateAdhesion){
        $requete = "UPDATE Adherent SET mdp = :mdp, nomAdherent = :nomAdherent, prenomAdherent = :prenomAdherent, email = :email, dateAdhesion = :dateAdhesion, numCategorie = 1 WHERE login = :login";
        $req_prep = Connexion::pdo()->prepare($requete);
        $tab = array(
            "login" => $login,
            "mdp" => $mdp,
            "nomAdherent" => $nom,
            "prenomAdherent" => $prenom,
            "email" => $email,
            "dateAdhesion" => $dateAdhesion,
        );
        try {
            $req_prep->execute($tab);
            return true;
        } catch (PDOException $e) {
            echo "Erreur de modification : " . $e->getMessage();
            return false;
        }
    }

}